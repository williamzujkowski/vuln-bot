{"version":3,"file":"image-optimization.js","mappings":"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","sources":["webpack://vuln-bot/webpack/bootstrap","webpack://vuln-bot/webpack/runtime/define property getters","webpack://vuln-bot/webpack/runtime/hasOwnProperty shorthand","webpack://vuln-bot/webpack/runtime/make namespace object","webpack://vuln-bot/./src/assets/ts/image-optimization.ts"],"sourcesContent":["// The require scope\nvar __webpack_require__ = {};\n\n","// define getter functions for harmony exports\n__webpack_require__.d = (exports, definition) => {\n\tfor(var key in definition) {\n\t\tif(__webpack_require__.o(definition, key) && !__webpack_require__.o(exports, key)) {\n\t\t\tObject.defineProperty(exports, key, { enumerable: true, get: definition[key] });\n\t\t}\n\t}\n};","__webpack_require__.o = (obj, prop) => (Object.prototype.hasOwnProperty.call(obj, prop))","// define __esModule on exports\n__webpack_require__.r = (exports) => {\n\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n\t}\n\tObject.defineProperty(exports, '__esModule', { value: true });\n};","/**\n * Image optimization and lazy loading utilities\n */\n\ninterface ImageOptimizationConfig {\n  rootMargin?: string;\n  threshold?: number;\n  loadingClass?: string;\n  loadedClass?: string;\n  errorClass?: string;\n}\n\nexport class ImageOptimization {\n  private observer: IntersectionObserver | null = null;\n  private config: Required<ImageOptimizationConfig>;\n\n  constructor(config: ImageOptimizationConfig = {}) {\n    this.config = {\n      rootMargin: config.rootMargin ?? '50px',\n      threshold: config.threshold ?? 0.1,\n      loadingClass: config.loadingClass ?? 'loading',\n      loadedClass: config.loadedClass ?? 'loaded',\n      errorClass: config.errorClass ?? 'error',\n    };\n\n    this.init();\n  }\n\n  private init(): void {\n    if (!('IntersectionObserver' in window)) {\n      // Fallback for browsers without IntersectionObserver\n      this.loadAllImages();\n      return;\n    }\n\n    this.observer = new IntersectionObserver(\n        (entries) => {\n          entries.forEach((entry) => {\n            if (entry.isIntersecting) {\n              this.loadImage(entry.target as HTMLImageElement);\n              this.observer?.unobserve(entry.target);\n            }\n          });\n        },\n        {\n          rootMargin: this.config.rootMargin,\n          threshold: this.config.threshold,\n        },\n    );\n\n    this.observeImages();\n  }\n\n  private observeImages(): void {\n    const images = document.querySelectorAll('img[loading=\"lazy\"], img[data-src]');\n    images.forEach((img) => {\n      this.observer?.observe(img);\n    });\n  }\n\n  private loadImage(img: HTMLImageElement): void {\n    const src = img.dataset.src ?? img.src;\n    if (!src) return;\n\n    img.classList.add(this.config.loadingClass);\n\n    // Create a new image to preload\n    const imageLoader = new Image();\n\n    imageLoader.onload = () => {\n      img.src = src;\n      img.classList.remove(this.config.loadingClass);\n      img.classList.add(this.config.loadedClass);\n\n      // Remove data-src to prevent reloading\n      delete img.dataset.src;\n    };\n\n    imageLoader.onerror = () => {\n      img.classList.remove(this.config.loadingClass);\n      img.classList.add(this.config.errorClass);\n      console.warn(`Failed to load image: ${src}`);\n    };\n\n    imageLoader.src = src;\n  }\n\n  private loadAllImages(): void {\n    const images = document.querySelectorAll('img[data-src]');\n    images.forEach((img) => {\n      this.loadImage(img as HTMLImageElement);\n    });\n  }\n\n  public refresh(): void {\n    if (this.observer) {\n      this.observeImages();\n    }\n  }\n\n  public destroy(): void {\n    if (this.observer) {\n      this.observer.disconnect();\n      this.observer = null;\n    }\n  }\n}\n\n/**\n * WebP support detection and image format optimization\n */\nexport class ImageFormatOptimizer {\n  private static webpSupported: boolean | null = null;\n\n  static async checkWebPSupport(): Promise<boolean> {\n    if (this.webpSupported !== null) {\n      return this.webpSupported;\n    }\n\n    return new Promise((resolve) => {\n      const webp = new Image();\n      webp.onload = webp.onerror = () => {\n        this.webpSupported = webp.height === 2;\n        resolve(this.webpSupported);\n      };\n      webp.src = 'data:image/webp;base64,UklGRjoAAABXRUJQVlA4IC4AAACyAgCdASoCAAIALmk0mk0iIiIiIgBoSygABc6WWgAA/veff/0PP8bA//LwYAAA';\n    });\n  }\n\n  static async optimizeImageSrc(originalSrc: string): Promise<string> {\n    const webpSupported = await this.checkWebPSupport();\n\n    if (webpSupported && !originalSrc.includes('.webp')) {\n      // Try to get WebP version\n      const webpSrc = originalSrc.replace(/\\.(jpg|jpeg|png)$/i, '.webp');\n\n      // Check if WebP version exists\n      return new Promise((resolve) => {\n        const img = new Image();\n        img.onload = () => resolve(webpSrc);\n        img.onerror = () => resolve(originalSrc);\n        img.src = webpSrc;\n      });\n    }\n\n    return originalSrc;\n  }\n}\n\n/**\n * Responsive image sizes calculator\n */\nexport class ResponsiveImageSizes {\n  static calculateSizes(breakpoints: Record<string, number> = {}): string {\n    const defaultBreakpoints = {\n      sm: 640,\n      md: 768,\n      lg: 1024,\n      xl: 1280,\n      ...breakpoints,\n    };\n\n    const sizes = [];\n\n    // Mobile first approach\n    sizes.push('100vw');\n\n    // Add breakpoint-specific sizes\n    Object.entries(defaultBreakpoints)\n        .sort(([, a], [, b]) => a - b)\n        .forEach(([name, width]) => {\n          if (name === 'sm') {\n            sizes.unshift('(max-width: 640px) 100vw');\n          } else if (name === 'md') {\n            sizes.unshift('(max-width: 768px) 50vw');\n          } else if (name === 'lg') {\n            sizes.unshift('(max-width: 1024px) 33vw');\n          } else {\n            sizes.unshift(`(max-width: ${width}px) 25vw`);\n          }\n        });\n\n    return sizes.join(', ');\n  }\n\n  static generateSrcSet(\n    baseSrc: string,\n    widths: number[] = [320, 640, 768, 1024, 1280, 1920]\n  ): string {\n    return widths\n        .map((width) => {\n          const src = baseSrc.replace(/(\\.[^.]+)$/, `_${width}w$1`);\n          return `${src} ${width}w`;\n        })\n        .join(', ');\n  }\n}\n\n/**\n * Image performance monitoring\n */\nexport class ImagePerformanceMonitor {\n  private static measurements: Map<string, number> = new Map();\n\n  static startMeasurement(imageId: string): void {\n    this.measurements.set(imageId, performance.now());\n  }\n\n  static endMeasurement(imageId: string): number {\n    const startTime = this.measurements.get(imageId);\n    if (!startTime) return 0;\n\n    const endTime = performance.now();\n    const duration = endTime - startTime;\n\n    this.measurements.delete(imageId);\n    return duration;\n  }\n\n  static measureImageLoad(img: HTMLImageElement): Promise<number> {\n    return new Promise((resolve) => {\n      const startTime = performance.now();\n\n      const onLoad = () => {\n        const duration = performance.now() - startTime;\n        img.removeEventListener('load', onLoad);\n        img.removeEventListener('error', onError);\n        resolve(duration);\n      };\n\n      const onError = () => {\n        const duration = performance.now() - startTime;\n        img.removeEventListener('load', onLoad);\n        img.removeEventListener('error', onError);\n        resolve(duration);\n      };\n\n      if (img.complete) {\n        resolve(0);\n      } else {\n        img.addEventListener('load', onLoad);\n        img.addEventListener('error', onError);\n      }\n    });\n  }\n}\n\n// Initialize image optimization when DOM is ready\ndocument.addEventListener('DOMContentLoaded', () => {\n  const imageOptimizer = new ImageOptimization();\n\n  // Re-observe images when new content is added dynamically\n  const observer = new MutationObserver(() => {\n    imageOptimizer.refresh();\n  });\n\n  observer.observe(document.body, {\n    childList: true,\n    subtree: true,\n  });\n});\n\n// Export for use in other modules\nexport {ImageOptimization as default};\n"],"names":[],"sourceRoot":""}