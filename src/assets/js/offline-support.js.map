{"version":3,"file":"offline-support.js","mappings":"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","sources":["webpack://vuln-bot/webpack/bootstrap","webpack://vuln-bot/webpack/runtime/define property getters","webpack://vuln-bot/webpack/runtime/hasOwnProperty shorthand","webpack://vuln-bot/webpack/runtime/make namespace object","webpack://vuln-bot/./src/assets/ts/offline-support.ts"],"sourcesContent":["// The require scope\nvar __webpack_require__ = {};\n\n","// define getter functions for harmony exports\n__webpack_require__.d = (exports, definition) => {\n\tfor(var key in definition) {\n\t\tif(__webpack_require__.o(definition, key) && !__webpack_require__.o(exports, key)) {\n\t\t\tObject.defineProperty(exports, key, { enumerable: true, get: definition[key] });\n\t\t}\n\t}\n};","__webpack_require__.o = (obj, prop) => (Object.prototype.hasOwnProperty.call(obj, prop))","// define __esModule on exports\n__webpack_require__.r = (exports) => {\n\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n\t}\n\tObject.defineProperty(exports, '__esModule', { value: true });\n};","/**\n * Offline support and service worker registration\n */\n\ninterface ServiceWorkerStatus {\n  supported: boolean;\n  registered: boolean;\n  offline: boolean;\n  updating: boolean;\n}\n\nexport class OfflineSupport {\n  private status: ServiceWorkerStatus = {\n    supported: 'serviceWorker' in navigator,\n    registered: false,\n    offline: !navigator.onLine,\n    updating: false,\n  };\n\n  private listeners: Map<string, Function[]> = new Map();\n\n  constructor() {\n    this.init();\n  }\n\n  private init(): void {\n    if (!this.status.supported) {\n      console.warn('Service Worker not supported');\n      return;\n    }\n\n    this.registerServiceWorker();\n    this.setupOnlineOfflineListeners();\n    this.setupVisibilityChangeListener();\n  }\n\n  private async registerServiceWorker(): Promise<void> {\n    try {\n      const registration = await navigator.serviceWorker.register('/vuln-bot/assets/js/service-worker.js', {\n        scope: '/vuln-bot/',\n      });\n\n      console.log('Service Worker registered successfully');\n      this.status.registered = true;\n      this.emit('registered', registration);\n\n      // Listen for service worker updates\n      registration.addEventListener('updatefound', () => {\n        this.status.updating = true;\n        this.emit('updatefound');\n\n        const newWorker = registration.installing;\n        if (newWorker) {\n          newWorker.addEventListener('statechange', () => {\n            if (newWorker.state === 'installed' && navigator.serviceWorker.controller) {\n              this.status.updating = false;\n              this.emit('updateready');\n            }\n          });\n        }\n      });\n\n      // Listen for service worker messages\n      navigator.serviceWorker.addEventListener('message', (event) => {\n        this.handleServiceWorkerMessage(event.data);\n      });\n\n      // Register for background sync (if supported)\n      if ('sync' in registration) {\n        this.setupBackgroundSync(registration);\n      }\n    } catch (error) {\n      console.error('Service Worker registration failed:', error);\n      this.emit('error', error);\n    }\n  }\n\n  private setupOnlineOfflineListeners(): void {\n    window.addEventListener('online', () => {\n      this.status.offline = false;\n      this.emit('online');\n      this.syncWhenOnline();\n    });\n\n    window.addEventListener('offline', () => {\n      this.status.offline = true;\n      this.emit('offline');\n    });\n  }\n\n  private setupVisibilityChangeListener(): void {\n    document.addEventListener('visibilitychange', () => {\n      if (!document.hidden && navigator.onLine) {\n        this.syncWhenOnline();\n      }\n    });\n  }\n\n  private async setupBackgroundSync(registration: ServiceWorkerRegistration): Promise<void> {\n    try {\n      await (registration as any).sync.register('background-sync-vulns');\n      console.log('Background sync registered');\n    } catch {\n      console.log('Background sync not supported or failed to register');\n    }\n  }\n\n  private handleServiceWorkerMessage(data: any): void {\n    switch (data.type) {\n      case 'DATA_UPDATED':\n        this.emit('data-updated', data.message);\n        break;\n      default:\n        console.log('Unhandled service worker message:', data);\n    }\n  }\n\n  private async syncWhenOnline(): Promise<void> {\n    if (!navigator.onLine || !this.status.registered) return;\n\n    try {\n      // Trigger background sync if available\n      const registration = await navigator.serviceWorker.ready;\n      if ('sync' in registration) {\n        await (registration as any).sync.register('background-sync-vulns');\n      }\n    } catch (error) {\n      console.log('Background sync trigger failed:', error);\n    }\n  }\n\n  public getStatus(): ServiceWorkerStatus {\n    return {...this.status};\n  }\n\n  public isOffline(): boolean {\n    return this.status.offline;\n  }\n\n  public isSupported(): boolean {\n    return this.status.supported;\n  }\n\n  public async updateServiceWorker(): Promise<void> {\n    if (!this.status.registered) return;\n\n    try {\n      const registration = await navigator.serviceWorker.ready;\n      await registration.update();\n      this.emit('update-triggered');\n    } catch (error) {\n      console.error('Service worker update failed:', error);\n      this.emit('error', error);\n    }\n  }\n\n  public async skipWaiting(): Promise<void> {\n    const registration = await navigator.serviceWorker.ready;\n    if (registration.waiting) {\n      registration.waiting.postMessage({type: 'SKIP_WAITING'});\n    }\n  }\n\n  // Event system\n  public on(event: string, callback: Function): void {\n    if (!this.listeners.has(event)) {\n      this.listeners.set(event, []);\n    }\n    this.listeners.get(event)!.push(callback);\n  }\n\n  public off(event: string, callback: Function): void {\n    const callbacks = this.listeners.get(event);\n    if (callbacks) {\n      const index = callbacks.indexOf(callback);\n      if (index > -1) {\n        callbacks.splice(index, 1);\n      }\n    }\n  }\n\n  private emit(event: string, data?: any): void {\n    const callbacks = this.listeners.get(event);\n    if (callbacks) {\n      callbacks.forEach((callback) => callback(data));\n    }\n  }\n}\n\n/**\n * Offline indicator component\n */\nexport class OfflineIndicator {\n  private element: HTMLElement | null = null;\n  private offlineSupport: OfflineSupport;\n\n  constructor(offlineSupport: OfflineSupport) {\n    this.offlineSupport = offlineSupport;\n    this.createIndicator();\n    this.setupEventListeners();\n  }\n\n  private createIndicator(): void {\n    this.element = document.createElement('div');\n    this.element.id = 'offline-indicator';\n    this.element.className = 'offline-indicator';\n    this.element.setAttribute('role', 'status');\n    this.element.setAttribute('aria-live', 'polite');\n    this.element.style.cssText = `\n      position: fixed;\n      top: 0;\n      left: 0;\n      right: 0;\n      background: #dc2626;\n      color: white;\n      text-align: center;\n      padding: 8px;\n      font-size: 14px;\n      transform: translateY(-100%);\n      transition: transform 0.3s ease;\n      z-index: 9999;\n    `;\n\n    document.body.appendChild(this.element);\n  }\n\n  private setupEventListeners(): void {\n    this.offlineSupport.on('offline', () => {\n      this.show('You are currently offline. Some features may be limited.');\n    });\n\n    this.offlineSupport.on('online', () => {\n      this.show('Connection restored. Syncing data...', 'success');\n      setTimeout(() => this.hide(), 3000);\n    });\n\n    this.offlineSupport.on('data-updated', (message: string) => {\n      this.show(message, 'info');\n      setTimeout(() => this.hide(), 3000);\n    });\n\n    this.offlineSupport.on('updateready', () => {\n      this.show('New version available. Refresh to update.', 'warning');\n    });\n  }\n\n  private show(message: string, type: 'error' | 'success' | 'info' | 'warning' = 'error'): void {\n    if (!this.element) return;\n\n    const colors = {\n      error: '#dc2626',\n      success: '#10b981',\n      info: '#2563eb',\n      warning: '#f59e0b',\n    };\n\n    this.element.textContent = message;\n    this.element.style.backgroundColor = colors[type];\n    this.element.style.transform = 'translateY(0)';\n  }\n\n  private hide(): void {\n    if (!this.element) return;\n    this.element.style.transform = 'translateY(-100%)';\n  }\n}\n\n/**\n * Cache management utilities\n */\nexport class CacheManager {\n  static async getCacheSize(): Promise<number> {\n    if (!('caches' in window)) return 0;\n\n    let totalSize = 0;\n    const cacheNames = await caches.keys();\n\n    for (const name of cacheNames) {\n      const cache = await caches.open(name);\n      const keys = await cache.keys();\n\n      for (const request of keys) {\n        const response = await cache.match(request);\n        if (response) {\n          const blob = await response.blob();\n          totalSize += blob.size;\n        }\n      }\n    }\n\n    return totalSize;\n  }\n\n  static async clearCache(): Promise<void> {\n    if (!('caches' in window)) return;\n\n    const cacheNames = await caches.keys();\n    await Promise.all(\n        cacheNames.map((name) => caches.delete(name)),\n    );\n  }\n\n  static formatBytes(bytes: number): string {\n    if (bytes === 0) return '0 Bytes';\n\n    const k = 1024;\n    const sizes = ['Bytes', 'KB', 'MB', 'GB'];\n    const i = Math.floor(Math.log(bytes) / Math.log(k));\n\n    return parseFloat((bytes / Math.pow(k, i)).toFixed(2)) + ' ' + sizes[i];\n  }\n}\n\n// Initialize offline support when DOM is ready\ndocument.addEventListener('DOMContentLoaded', () => {\n  const offlineSupport = new OfflineSupport();\n  new OfflineIndicator(offlineSupport);\n\n  // Expose to global scope for debugging\n  (window as any).offlineSupport = offlineSupport;\n  (window as any).cacheManager = CacheManager;\n});\n\nexport {OfflineSupport as default};\n"],"names":[],"sourceRoot":""}