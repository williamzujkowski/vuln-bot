/**
 * Vulnerability data types
 */

export type SeverityLevel = "CRITICAL" | "HIGH" | "MEDIUM" | "LOW" | "NONE";

export type ExploitationStatus = "ACTIVE" | "POC" | "UNPROVEN" | "UNKNOWN";

export interface Reference {
  url: string;
  source: string;
  tags: string[];
}

export interface CVSSMetric {
  version: string;
  vectorString: string;
  baseScore: number;
  baseSeverity: SeverityLevel;
  exploitabilityScore?: number;
  impactScore?: number;
}

export interface Vulnerability {
  cveId: string;
  title: string;
  description: string;
  publishedDate: string;
  lastModifiedDate: string;
  severity: SeverityLevel;
  cvssScore: number;
  cvssMetrics: CVSSMetric[];
  epssScore: number;
  epssPercentile: number;
  riskScore: number;
  exploitationStatus: ExploitationStatus;
  vendors: string[];
  products: string[];
  references: Reference[];
  tags: string[];
  sources: Array<{
    name: string;
    url: string;
    lastModified: string;
  }>;
}

export interface VulnerabilityResponse {
  vulnerabilities: Vulnerability[];
  metadata: {
    totalCount: number;
    lastUpdated: string;
    version: string;
  };
}

export interface FilterState {
  cvssMin: number;
  cvssMax: number;
  epssMin: number;
  epssMax: number;
  severity: SeverityLevel | "";
  dateFrom: string;
  dateTo: string;
  vendor: string;
  tags: string[];
}

export interface SortConfig {
  field: keyof Vulnerability;
  direction: "asc" | "desc";
}

export interface PaginationConfig {
  currentPage: number;
  pageSize: number;
  totalPages: number;
}

export interface DashboardState {
  vulnerabilities: Vulnerability[];
  filteredVulns: Vulnerability[];
  paginatedVulns: Vulnerability[];
  searchQuery: string;
  filters: FilterState;
  sort: SortConfig;
  pagination: PaginationConfig;
  loading: boolean;
  error: string | null;
  initialLoad: boolean;
}
