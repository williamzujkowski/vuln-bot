/**
 * Vulnerability data types
 */

export type SeverityLevel = "CRITICAL" | "HIGH" | "MEDIUM" | "LOW" | "NONE";

export type ExploitationStatus = "ACTIVE" | "POC" | "UNPROVEN" | "UNKNOWN";

export interface Reference {
  url: string;
  source: string;
  tags: string[];
}

export interface CVSSMetric {
  version: string;
  vectorString: string;
  baseScore: number;
  baseSeverity: SeverityLevel;
  exploitabilityScore?: number;
  impactScore?: number;
}

export interface Vulnerability {
  cveId: string;
  title: string;
  description: string;
  publishedDate: string;
  lastModifiedDate?: string; // Optional - not included in index.json
  severity: SeverityLevel;
  cvssScore: number;
  cvssMetrics?: CVSSMetric[]; // Optional - not included in index.json
  epssScore: number;
  epssPercentile: number;
  riskScore: number;
  exploitationStatus: ExploitationStatus;
  vendors: string[];
  products?: string[]; // Optional - not included in index.json
  references?: Reference[]; // Optional - not included in index.json
  tags: string[];
  sources?: Array<{
    // Optional - not included in index.json
    name: string;
    url: string;
    lastModified: string;
  }>;
}

export interface VulnerabilityResponse {
  vulnerabilities: Vulnerability[];
  metadata: {
    totalCount: number;
    lastUpdated: string;
    version: string;
  };
}

export interface FilterState {
  cvssMin: number;
  cvssMax: number;
  epssMin: number;
  epssMax: number;
  severity: SeverityLevel | "";
  publishedDateFrom: string;
  publishedDateTo: string;
  lastModifiedDateFrom: string;
  lastModifiedDateTo: string;
  dateFrom: string; // deprecated, kept for backwards compatibility
  dateTo: string; // deprecated, kept for backwards compatibility
  vendor: string;
  tags: string[];
}

export interface SortConfig {
  field: keyof Vulnerability;
  direction: "asc" | "desc";
}

export interface PaginationConfig {
  currentPage: number;
  pageSize: number;
  totalPages: number;
}

export interface DashboardState {
  vulnerabilities: Vulnerability[];
  filteredVulns: Vulnerability[];
  paginatedVulns: Vulnerability[];
  searchQuery: string;
  filters: FilterState;
  sort: SortConfig;
  pagination: PaginationConfig;
  loading: boolean;
  error: string | null;
  initialLoad: boolean;
}
