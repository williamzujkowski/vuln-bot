{
  "cveId": "CVE-2024-31462",
  "title": "Limited file write in Stable-diffusion-webui - GHSL-2024-010",
  "description": "stable-diffusion-webui is a web interface for Stable Diffusion, implemented using Gradio library. Stable-diffusion-webui 1.7.0 is vulnerable to a limited file write affecting Windows systems. The create_ui method (Backup/Restore tab) in modules/ui_extensions.py takes user input into the config_save_name variable on line 653. This user input is later used in the save_config_state method and used to create a file path on line 65, which is afterwards opened for writing on line 67, which leads to a limited file write exploitable on Windows systems. This issue may lead to limited file write. It allows for writing json files anywhere on the server where the web server has access.",
  "publishedDate": "2024-04-12T21:41:46.345000+00:00",
  "lastModifiedDate": "2024-08-02T01:52:57.047000+00:00",
  "severity": "MEDIUM",
  "cvssMetrics": [
    {
      "version": "3.1",
      "vectorString": "CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:L/I:L/A:L",
      "baseScore": 6.3,
      "baseSeverity": "MEDIUM"
    }
  ],
  "epss": {
    "score": 0.0018,
    "percentile": 40.166
  },
  "riskScore": 38,
  "exploitationStatus": "UNKNOWN",
  "affectedSystems": {
    "cpeMatches": [],
    "vendors": ["automatic1111"],
    "products": ["stable-diffusion-webui"]
  },
  "references": [
    {
      "url": "https://securitylab.github.com/advisories/GHSL-2024-010_stable-diffusion-webui/",
      "source": "https://securitylab.github.com/advisories/GHSL-2024-010_stable-diffusion-webui/",
      "tags": ["x_refsource_CONFIRM"]
    },
    {
      "url": "https://github.com/AUTOMATIC1111/stable-diffusion-webui/commit/d9708c92b444894bce8070e4dcfaa093f8eb8d43",
      "source": "https://github.com/AUTOMATIC1111/stable-diffusion-webui/commit/d9708c92b444894bce8070e4dcfaa093f8eb8d43",
      "tags": ["x_refsource_MISC"]
    },
    {
      "url": "https://github.com/AUTOMATIC1111/stable-diffusion-webui/blob/cf2772fab0af5573da775e7437e6acdca424f26e/modules/ui_extensions.py#L59",
      "source": "https://github.com/AUTOMATIC1111/stable-diffusion-webui/blob/cf2772fab0af5573da775e7437e6acdca424f26e/modules/ui_extensions.py#L59",
      "tags": ["x_refsource_MISC"]
    },
    {
      "url": "https://github.com/AUTOMATIC1111/stable-diffusion-webui/blob/cf2772fab0af5573da775e7437e6acdca424f26e/modules/ui_extensions.py#L646-L660",
      "source": "https://github.com/AUTOMATIC1111/stable-diffusion-webui/blob/cf2772fab0af5573da775e7437e6acdca424f26e/modules/ui_extensions.py#L646-L660",
      "tags": ["x_refsource_MISC"]
    },
    {
      "url": "https://github.com/AUTOMATIC1111/stable-diffusion-webui/blob/cf2772fab0af5573da775e7437e6acdca424f26e/modules/ui_extensions.py#L65",
      "source": "https://github.com/AUTOMATIC1111/stable-diffusion-webui/blob/cf2772fab0af5573da775e7437e6acdca424f26e/modules/ui_extensions.py#L65",
      "tags": ["x_refsource_MISC"]
    },
    {
      "url": "https://github.com/AUTOMATIC1111/stable-diffusion-webui/blob/cf2772fab0af5573da775e7437e6acdca424f26e/modules/ui_extensions.py#L653",
      "source": "https://github.com/AUTOMATIC1111/stable-diffusion-webui/blob/cf2772fab0af5573da775e7437e6acdca424f26e/modules/ui_extensions.py#L653",
      "tags": ["x_refsource_MISC"]
    },
    {
      "url": "https://github.com/AUTOMATIC1111/stable-diffusion-webui/blob/cf2772fab0af5573da775e7437e6acdca424f26e/modules/ui_extensions.py#L67",
      "source": "https://github.com/AUTOMATIC1111/stable-diffusion-webui/blob/cf2772fab0af5573da775e7437e6acdca424f26e/modules/ui_extensions.py#L67",
      "tags": ["x_refsource_MISC"]
    },
    {
      "url": "https://github.com/AUTOMATIC1111/stable-diffusion-webui/blob/v1.7.0/modules/ui_extensions.py",
      "source": "https://github.com/AUTOMATIC1111/stable-diffusion-webui/blob/v1.7.0/modules/ui_extensions.py",
      "tags": ["x_refsource_MISC"]
    },
    {
      "url": "https://github.com/AUTOMATIC1111/stable-diffusion-webui/discussions/15461",
      "source": "https://github.com/AUTOMATIC1111/stable-diffusion-webui/discussions/15461",
      "tags": ["x_refsource_MISC"]
    },
    {
      "url": "https://securitylab.github.com/advisories/GHSL-2024-010_stable-diffusion-webui",
      "source": "https://securitylab.github.com/advisories/GHSL-2024-010_stable-diffusion-webui",
      "tags": ["x_refsource_MISC"]
    }
  ],
  "attackTechniques": [],
  "metadata": {
    "tags": ["CWE-22"],
    "requiresUserInteraction": null,
    "requiresPrivileges": null,
    "attackVector": null,
    "sources": [
      {
        "name": "CVEList",
        "url": "https://github.com/CVEProject/cvelistV5/blob/main/cves/2024/31xxx/CVE-2024-31462.json",
        "lastModified": "2024-08-02T01:52:57.047000+00:00"
      }
    ]
  }
}
