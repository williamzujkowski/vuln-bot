{
  "cveId": "CVE-2024-47077",
  "title": "authentik cross-provider token validation problems",
  "description": "authentik is an open-source identity provider. Prior to versions 2024.8.3 and 2024.6.5, access tokens issued to one application can be stolen by that application and used to impersonate the user against any other proxy provider. Also, a user can steal an access token they were legitimately issued for one application and use it to access another application that they aren't allowed to access. Anyone who has more than one proxy provider application with different trust domains or different access control is affected. Versions 2024.8.3 and 2024.6.5 fix the issue.",
  "publishedDate": "2024-09-27T15:26:20.683000+00:00",
  "lastModifiedDate": "2024-09-27T17:51:19.674000+00:00",
  "severity": "MEDIUM",
  "cvssMetrics": [
    {
      "version": "3.1",
      "vectorString": "CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:N/I:H/A:N",
      "baseScore": 6.5,
      "baseSeverity": "MEDIUM"
    }
  ],
  "epss": {
    "score": 0.001,
    "percentile": 29.274
  },
  "riskScore": 38,
  "exploitationStatus": "UNKNOWN",
  "affectedSystems": {
    "cpeMatches": [],
    "vendors": ["goauthentik"],
    "products": ["authentik"]
  },
  "references": [
    {
      "url": "https://github.com/goauthentik/authentik/security/advisories/GHSA-8gfm-pr6x-pfh9",
      "source": "https://github.com/goauthentik/authentik/security/advisories/GHSA-8gfm-pr6x-pfh9",
      "tags": ["x_refsource_CONFIRM"]
    },
    {
      "url": "https://github.com/goauthentik/authentik/commit/22e586bd8cdc3d1db8a0f18314d76f82371129b2",
      "source": "https://github.com/goauthentik/authentik/commit/22e586bd8cdc3d1db8a0f18314d76f82371129b2",
      "tags": ["x_refsource_MISC"]
    },
    {
      "url": "https://github.com/goauthentik/authentik/commit/57a31b5dd16d4adce716b9878455c0d6f58155fe",
      "source": "https://github.com/goauthentik/authentik/commit/57a31b5dd16d4adce716b9878455c0d6f58155fe",
      "tags": ["x_refsource_MISC"]
    },
    {
      "url": "https://github.com/goauthentik/authentik/blob/70b5a214f2e7205572f914aaf68682501b9f5945/authentik/providers/oauth2/views/introspection.py#L42-L51",
      "source": "https://github.com/goauthentik/authentik/blob/70b5a214f2e7205572f914aaf68682501b9f5945/authentik/providers/oauth2/views/introspection.py#L42-L51",
      "tags": ["x_refsource_MISC"]
    },
    {
      "url": "https://github.com/goauthentik/authentik/blob/70b5a214f2e7205572f914aaf68682501b9f5945/internal/outpost/proxyv2/application/auth_bearer.go#L30-L36",
      "source": "https://github.com/goauthentik/authentik/blob/70b5a214f2e7205572f914aaf68682501b9f5945/internal/outpost/proxyv2/application/auth_bearer.go#L30-L36",
      "tags": ["x_refsource_MISC"]
    }
  ],
  "attackTechniques": [],
  "metadata": {
    "tags": ["CWE-863"],
    "requiresUserInteraction": null,
    "requiresPrivileges": null,
    "attackVector": null,
    "sources": [
      {
        "name": "CVEList",
        "url": "https://github.com/CVEProject/cvelistV5/blob/main/cves/2024/47xxx/CVE-2024-47077.json",
        "lastModified": "2024-09-27T17:51:19.674000+00:00"
      }
    ]
  }
}
